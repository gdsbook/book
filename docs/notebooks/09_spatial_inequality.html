<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Spatial Inequality</title>
  <meta name="description" content="        Spatial Inequality    Spatial Inequality Analysis Introduction At the time this is being written, the topic of inequality is at the top ofagenda of p...">

  <link rel="canonical" href="https://geographicdata.science/book/notebooks/09_spatial_inequality.html">
  <link rel="alternate" type="application/rss+xml" title="Geographic Data Science with Python" href="https://geographicdata.science/book/feed.xml">

  <meta property="og:url"         content="https://geographicdata.science/book/notebooks/09_spatial_inequality.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Spatial Inequality" />
<meta property="og:description" content="        Spatial Inequality    Spatial Inequality Analysis Introduction At the time this is being written, the topic of inequality is at the top ofagenda of p..." />
<meta property="og:image"       content="https://geographicdata.science/book/images/logo/logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://geographicdata.science/book/notebooks/09_spatial_inequality.html",
  "headline": "Spatial Inequality",
  "datePublished": "2020-04-20T17:12:24+00:00",
  "dateModified": "2020-04-20T17:12:24+00:00",
  "description": "        Spatial Inequality    Spatial Inequality Analysis Introduction At the time this is being written, the topic of inequality is at the top ofagenda of p...",
  "author": {
    "@type": "Person",
    "name": "Sergio J. Rey, Dani Arribas-Bel, Levi J. Wolf"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://geographicdata.science/book",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://geographicdata.science/book",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/book/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/book/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/book/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/book/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/book';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/book/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/book/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146598819-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146598819-1');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/book/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/book/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/book/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://geographicdata.science") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/book/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/book/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/book/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Geographic Data Science - The Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "gdsbook/book",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python3",
    path: "content/notebooks"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://geographicdata.science"><img src="/book/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Geographic Data Science with Python</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/book/intro.html"
        >
          
          Home
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/notebooks/00_toc">
        <a class="c-sidebar__entry"
          href="/book/notebooks/00_toc.html"
        >
          
          Table of Contents
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro_part_i">
        <a class="c-sidebar__entry"
          href="/book/intro_part_i.html"
        >
          
          Part I - Building Blocks
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/01_geospatial_computational_environment">
              <a class="c-sidebar__entry"
                href="/book/notebooks/01_geospatial_computational_environment.html"
              >
                
                Geospatial Computational Environment
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/02_spatial_data">
              <a class="c-sidebar__entry"
                href="/book/notebooks/02_spatial_data.html"
              >
                
                Spatial Data
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/03_spatial_data_processing">
              <a class="c-sidebar__entry"
                href="/book/notebooks/03_spatial_data_processing.html"
              >
                
                Spatial Data Processing
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/04_spatial_weights">
              <a class="c-sidebar__entry"
                href="/book/notebooks/04_spatial_weights.html"
              >
                
                Spatial Weights
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro_part_ii">
        <a class="c-sidebar__entry"
          href="/book/intro_part_ii.html"
        >
          
          Part II - Spatial Data Analysis
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/05_choropleth">
              <a class="c-sidebar__entry"
                href="/book/notebooks/05_choropleth.html"
              >
                
                Choropleth Mapping
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/06_spatial_autocorrelation">
              <a class="c-sidebar__entry"
                href="/book/notebooks/06_spatial_autocorrelation.html"
              >
                
                Spatial Autocorrelation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/07_local_autocorrelation">
              <a class="c-sidebar__entry"
                href="/book/notebooks/07_local_autocorrelation.html"
              >
                
                Local Spatial Autocorrelation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/08_point_pattern_analysis">
              <a class="c-sidebar__entry"
                href="/book/notebooks/08_point_pattern_analysis.html"
              >
                
                Point Pattern Analysis
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro_part_iii">
        <a class="c-sidebar__entry"
          href="/book/intro_part_iii.html"
        >
          
          Part III - Advanced Topics
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/09_spatial_inequality">
              <a class="c-sidebar__entry"
                href="/book/notebooks/09_spatial_inequality.html"
              >
                
                Spatial Inequality
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/10_clustering_and_regionalization">
              <a class="c-sidebar__entry"
                href="/book/notebooks/10_clustering_and_regionalization.html"
              >
                
                Clustering & Regionalization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/11_regression">
              <a class="c-sidebar__entry"
                href="/book/notebooks/11_regression.html"
              >
                
                Regression
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/notebooks/12_feature_engineering">
              <a class="c-sidebar__entry"
                href="/book/notebooks/12_feature_engineering.html"
              >
                
                Spatial Feature Engineering
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/data/README">
        <a class="c-sidebar__entry"
          href="/book/data/README.html"
        >
          
          Datasets
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/airbnb/regression_cleaning">
              <a class="c-sidebar__entry"
                href="/book/data/airbnb/regression_cleaning.html"
              >
                
                AirBnb
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/airports/airports_cleaning">
              <a class="c-sidebar__entry"
                href="/book/data/airports/airports_cleaning.html"
              >
                
                Airports
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/brexit/README">
              <a class="c-sidebar__entry"
                href="/book/data/brexit/README.html"
              >
                
                Brexit
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/countries/countries_cleaning">
              <a class="c-sidebar__entry"
                href="/book/data/countries/countries_cleaning.html"
              >
                
                Countries
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/h3_grid/build_sd_h3_grid">
              <a class="c-sidebar__entry"
                href="/book/data/h3_grid/build_sd_h3_grid.html"
              >
                
                H3 Grid
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/mexico/README">
              <a class="c-sidebar__entry"
                href="/book/data/mexico/README.html"
              >
                
                Mexico
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/nasadem/build_nasadem_sd">
              <a class="c-sidebar__entry"
                href="/book/data/nasadem/build_nasadem_sd.html"
              >
                
                NASA DEM
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/texas/README">
              <a class="c-sidebar__entry"
                href="/book/data/texas/README.html"
              >
                
                Texas
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data/tokyo/tokyo_cleaning">
              <a class="c-sidebar__entry"
                href="/book/data/tokyo/tokyo_cleaning.html"
              >
                
                Tokyo Photographs
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/book/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        <a href="/book/content/notebooks/09_spatial_inequality.ipynb" download>
        <button id="interact-button-download" class="interact-button">.ipynb</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  
  
  






<a href="https://mybinder.org/v2/gh/gdsbook/book/master?filepath=content%2Fnotebooks%2F09_spatial_inequality.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/book/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/book/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/book/search.html" class="topbar-right-button" id="search-button">
    <img src="/book/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Spatial Inequality</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Spatial-Inequality-Analysis">Spatial Inequality Analysis<a class="anchor-link" href="#Spatial-Inequality-Analysis"> </a></h1><h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h2><p>At the time this is being written, the topic of inequality is at the top of
agenda of policy makers and is drawing considerable attention in academic
circles. This is due to historic levels of inequality across the globe
(references). Much of the focus has been on <em>interpersonal income inequality</em>,
yet there is a growing recognition that the question of <em>interregional income
inequality</em> requires further attention as the growing gaps between poor and rich
regions have been identified as key drivers of political polarization in
developing and developed countries (CITE ANDRES).</p>
<p>Indeed, while the two literatures, personal and regional inequality, are
related, they have developed in a largely parallel fashion with limited
cross-fertilization. In this notebook, we examine how a spatially explicit focus
can provide insights on inequality and its dynamics. We also show the lineage of
regional inequality analysis to make explicit the linkage between it and the
older literature on personal inequality analysis.</p>
<p>We begin with an introduction to classic methods for interpersonal income
inequality analysis and how they have been adopted to the question of regional
inequalities. These include a number of graphical tools along side familiar
indices of inequality. As we discuss more fully, the use of these classical
methods in spatially referenced data, while useful in providing insights on some
of the aspects of spatial inequality, fails to fully capture the nature of
geographical disparities and their dynamics. Thus, we next move to spatially
explicit measures for regional inequality analysis. The notebook closes with
some recent extensions of some classical measures to more fully examine the
spatial dimensions of regional inequality dynamics.</p>
<h2 id="Data:-US-State-Per-Capita-Income-1969-2017">Data: US State Per-Capita Income 1969-2017<a class="anchor-link" href="#Data:-US-State-Per-Capita-Income-1969-2017"> </a></h2><p>We focus on the case of the United States over the
period  1969-2017.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">pysal</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">mapclassify</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/us_county_income/usincome_final.shp&#39;</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>1970</th>
      <th>1971</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>...</th>
      <th>LineCode</th>
      <th>METDIVFP</th>
      <th>MTFCC</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>Region</th>
      <th>STATEFP</th>
      <th>TableName</th>
      <th>Unit</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3897</td>
      <td>3968</td>
      <td>4183</td>
      <td>4444</td>
      <td>4902</td>
      <td>5093</td>
      <td>5511</td>
      <td>5955</td>
      <td>6711</td>
      <td>7478</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Sauk</td>
      <td>Sauk County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-90.191964 43.554996, -90.196759 43....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3498</td>
      <td>3732</td>
      <td>3841</td>
      <td>4097</td>
      <td>4624</td>
      <td>4987</td>
      <td>5299</td>
      <td>5836</td>
      <td>6529</td>
      <td>7267</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Pierce</td>
      <td>Pierce County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-92.694542 44.68874, -92.694659 44.6...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3335</td>
      <td>3604</td>
      <td>3870</td>
      <td>4218</td>
      <td>4670</td>
      <td>5108</td>
      <td>5509</td>
      <td>6318</td>
      <td>6873</td>
      <td>7443</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>La Crosse</td>
      <td>La Crosse County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-91.347741 43.911964, -91.348743 43....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2740</td>
      <td>2953</td>
      <td>3275</td>
      <td>3482</td>
      <td>4014</td>
      <td>4335</td>
      <td>4733</td>
      <td>5169</td>
      <td>5885</td>
      <td>6323</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Dunn</td>
      <td>Dunn County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-92.135379 44.944807, -92.135378 44....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2711</td>
      <td>2936</td>
      <td>3289</td>
      <td>3720</td>
      <td>4214</td>
      <td>4588</td>
      <td>4923</td>
      <td>5512</td>
      <td>6067</td>
      <td>6383</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Jackson</td>
      <td>Jackson County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-91.166006 44.335102, -91.166004 44....</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspection of the head of the data frame reveals that the years appear as columns in the data set, together with information about the particular record.
This format is an example of a <a href="https://www.theanalysisfactor.com/wide-and-long-data/"><em>wide</em> longitudinal data set</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;LineCode&#39;</span><span class="p">,</span> <span class="s1">&#39;Descriptio&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LineCode</th>
      <th>Descriptio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>Per capita personal income (dollars) 2/</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Per capita personal income (dollars) 2/</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Per capita personal income (dollars) 2/</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Per capita personal income (dollars) 2/</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>Per capita personal income (dollars) 2/</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">LineCode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>1970</th>
      <th>1971</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>...</th>
      <th>LineCode</th>
      <th>METDIVFP</th>
      <th>MTFCC</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>Region</th>
      <th>STATEFP</th>
      <th>TableName</th>
      <th>Unit</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3897</td>
      <td>3968</td>
      <td>4183</td>
      <td>4444</td>
      <td>4902</td>
      <td>5093</td>
      <td>5511</td>
      <td>5955</td>
      <td>6711</td>
      <td>7478</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Sauk</td>
      <td>Sauk County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-90.191964 43.554996, -90.196759 43....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3498</td>
      <td>3732</td>
      <td>3841</td>
      <td>4097</td>
      <td>4624</td>
      <td>4987</td>
      <td>5299</td>
      <td>5836</td>
      <td>6529</td>
      <td>7267</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Pierce</td>
      <td>Pierce County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-92.694542 44.68874, -92.694659 44.6...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3335</td>
      <td>3604</td>
      <td>3870</td>
      <td>4218</td>
      <td>4670</td>
      <td>5108</td>
      <td>5509</td>
      <td>6318</td>
      <td>6873</td>
      <td>7443</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>La Crosse</td>
      <td>La Crosse County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-91.347741 43.911964, -91.348743 43....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2740</td>
      <td>2953</td>
      <td>3275</td>
      <td>3482</td>
      <td>4014</td>
      <td>4335</td>
      <td>4733</td>
      <td>5169</td>
      <td>5885</td>
      <td>6323</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Dunn</td>
      <td>Dunn County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-92.135379 44.944807, -92.135378 44....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2711</td>
      <td>2936</td>
      <td>3289</td>
      <td>3720</td>
      <td>4214</td>
      <td>4588</td>
      <td>4923</td>
      <td>5512</td>
      <td>6067</td>
      <td>6383</td>
      <td>...</td>
      <td>3</td>
      <td>None</td>
      <td>G4020</td>
      <td>Jackson</td>
      <td>Jackson County</td>
      <td>3</td>
      <td>55</td>
      <td>CAINC1</td>
      <td>Dollars</td>
      <td>POLYGON ((-91.166006 44.335102, -91.166004 44....</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3077, 76)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="p">[[</span><span class="s1">&#39;1969&#39;</span><span class="p">,</span> <span class="s1">&#39;STATEFP&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTYFP&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3897</td>
      <td>55</td>
      <td>111</td>
      <td>POLYGON ((-90.191964 43.554996, -90.196759 43....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3498</td>
      <td>55</td>
      <td>093</td>
      <td>POLYGON ((-92.694542 44.68874, -92.694659 44.6...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3335</td>
      <td>55</td>
      <td>063</td>
      <td>POLYGON ((-91.347741 43.911964, -91.348743 43....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2740</td>
      <td>55</td>
      <td>033</td>
      <td>POLYGON ((-92.135379 44.944807, -92.135378 44....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2711</td>
      <td>55</td>
      <td>053</td>
      <td>POLYGON ((-91.166006 44.335102, -91.166004 44....</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Global-Inequality">Global Inequality<a class="anchor-link" href="#Global-Inequality"> </a></h2><p>We begin our examination of inequality by focusing on several global measures. Here, global means the measure is concerned with the overall, or a-spatial, nature of inequality. Several classic measures of inequality are available for this purpose.</p>
<p>In general terms, measures of inequality focus on the dispersion present in an income distribution. In the case of regional, or spatial, inequality the distributions are defined on average or per-capita incomes for a spatial unit, such as a county, census tract, or region. For the US counties, we can visualize the distribution of per capita incomes for the first year in the sample as follows:</p>
<p>To get a sense for the value distribution for per capita income, we can first discretize the distribution:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span>  <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c3100940&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_11_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The long right tail is a prominent feature of the distribution, and is common in the study of incomes. A key point to keep in mind here is that the unit of measurement in this data is a spatial aggregate - a county. By contrast, in the wider inequality literature the observational unit is typically a household or individual. In the latter distributions, the degree of skewness is often more pronounced. (Say something about averaging effect for regional distributions).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The density is a powerful summary device that captures the overall morphology of the <em>value</em> distribution. At the same time, the density is silent on the underlying <em>spatial distribution</em> of county incomes. We can look at this second view of the distribution using a choropleth map:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pysal.viz</span> <span class="kn">import</span> <span class="n">mapclassify</span>
<span class="n">pci_1969</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">q5_1969</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">Quantiles</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="o">=</span> <span class="n">pci_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;1969&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
             <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="s1">&#39;lower right&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;bbox_to_anchor&#39;</span><span class="p">:(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_16_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SAY SOMETHING ABOUT CLUSTERING AND PATTERN
The choropleth and the kernel density provide different visual depictions of the distribution of county incomes. These are useful for developing an understanding of the overall  To gain more specific insights on the level of inequality in the distribution, we turn to a number of inequality indices.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="20:20-Ratio">20:20 Ratio<a class="anchor-link" href="#20:20-Ratio"> </a></h3><p>One commonly used measure of inequality in a distribution is the so called 20:20 ratio, which is defined as the ratio of the incomes at the 80th percentile over that at the 20th percentile: 
<!-- #endregion --></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">q5_1969</span><span class="o">.</span><span class="n">bins</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([2445.2, 2864.4, 3246.6, 3672.8, 7841. ])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">i_20_20</span> <span class="o">=</span> <span class="n">q5_1969</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">q5_1969</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">i_20_20</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.5020448225094063</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In 1969 the richest 20% of the counties had an income that was 1.5 times the poorest 20% of the counties. The 20:20 ratio has the advantage of being robust to outliers at the top and the bottom of the distribution.</p>
<p>We can examine the dynamics of this global inequality measure by creating a simple function to apply to all years in our time series:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ineq_2020</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="n">q5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">Quantiles</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q5</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">q5</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1969</span><span class="p">,</span> <span class="mi">2018</span><span class="p">))</span>
<span class="n">i_20_20_all</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">ineq_2020</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)])</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">i_20_20_all</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;20:20 ratio&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_23_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The ratio has a U-shaped pattern over time, bottoming out around 1994 after a long secular decline in the early period. Post 1994, however, the trend is one of increasing inequality up until 2013 where there is a turn towards lower income inequality between the counties.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For other classic measures of inequality, we will use the <code>inequality</code> package from <code>pysal</code>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pysal.explore</span> <span class="kn">import</span> <span class="n">inequality</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gini-Index">Gini Index<a class="anchor-link" href="#Gini-Index"> </a></h3><p>The Gini index can be derived in a number of ways. Visually, the Gini is defined as the ratio of the area between
the line of equality and the Lorenze curve, both of which are defined on a a two-dimensional space with population
percentiles on the x-axis and cumulative income on the vertical axis.</p>
<p>We can construct each of these as follows:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pci_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">])[</span><span class="s1">&#39;1969&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Fy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Fn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fn</span><span class="p">,</span><span class="n">Fy</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fn</span><span class="p">,</span> <span class="n">Fn</span><span class="p">)</span>
<span class="c1">#plt.xlim(0, 1.0)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fc8c302cc88&gt;]</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_32_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The blue line is the Lorenze curve, and the Gini is the area between it and the 45-degree line of equality, expressed as a ratio over the area under the line of equality.</p>
<p>To examine how inequality evolves over time, we can create a function for the Lorenze curve:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lorenz</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">Fy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Fn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="k">return</span> <span class="n">Fy</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lorenz</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1.22447634e-04, 2.52876417e-04, 3.83515230e-04, ...,
       9.98429814e-01, 9.99176576e-01, 1.00000000e+00])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and then call this for each year in our sample:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lorenz_curves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">lorenz</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)])</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lorenz_curves</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.22447634e-04, 2.52876417e-04, 3.83515230e-04, ...,
        9.98429814e-01, 9.99176576e-01, 1.00000000e+00],
       [1.34666135e-04, 2.74890539e-04, 4.17260239e-04, ...,
        9.98425742e-01, 9.99170258e-01, 1.00000000e+00],
       [1.35618488e-04, 2.73501814e-04, 4.16005410e-04, ...,
        9.98412258e-01, 9.99173062e-01, 1.00000000e+00],
       ...,
       [1.05611874e-04, 2.53894487e-04, 4.06125878e-04, ...,
        9.97122641e-01, 9.98365341e-01, 1.00000000e+00],
       [1.41986673e-04, 2.90860641e-04, 4.48503155e-04, ...,
        9.96903731e-01, 9.98211488e-01, 1.00000000e+00],
       [9.27373942e-05, 2.42055708e-04, 3.93106488e-04, ...,
        9.96816148e-01, 9.98183164e-01, 1.00000000e+00]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lorenz_curves</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(49, 3077)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fn</span><span class="p">,</span><span class="n">Fn</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lorenz_curves</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fn</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_40_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The compression of the Lorenze curves makes it difficult to ascertain the temporal pattern in inequality. Focusing explicilty on the Gini coefficients may shed more light on this evolution:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g69</span> <span class="o">=</span> <span class="n">inequality</span><span class="o">.</span><span class="n">gini</span><span class="o">.</span><span class="n">Gini</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g69</span><span class="o">.</span><span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.13553708123000455</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1969</span><span class="p">,</span> <span class="mi">2018</span><span class="p">)]</span>
<span class="n">ginis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inequality</span><span class="o">.</span><span class="n">gini</span><span class="o">.</span><span class="n">Gini</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">g</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">])</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">years</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gini_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="n">years</span><span class="p">,</span> <span class="n">ginis</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Gini&#39;</span><span class="p">])</span>
<span class="n">gini_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gini_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">gini_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Gini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1969</td>
      <td>0.135537</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1970</td>
      <td>0.130055</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1971</td>
      <td>0.128522</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1972</td>
      <td>0.129104</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1973</td>
      <td>0.142146</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gini_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gini_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y&quot;</span><span class="p">)</span>
<span class="n">gini_df</span> <span class="o">=</span> <span class="n">gini_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gini_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gini&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2ecc358&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_47_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>MAYBE ADD 
One interesting note about the relationship between the Gini coefficient, the Loreznze curve, and the spatial distribution of incomes</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Theil's-index">Theil's index<a class="anchor-link" href="#Theil's-index"> </a></h3><p>A third commonly used measure of inequality is Theil's $T$ given as:
$$T = \sum_{i=1}^m \left( \frac{y_i}{\sum_{i=1}^m y_i} \ln \left[ m \frac{y_i}{\sum_{i=1}^m y_i}\right] \right)$$
where $y_i$ is per-capita income in area $i$ among $m$ areas. In PySAL, we can calculate this index each year as:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gini_df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">Theil</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#gini_df.plot(figsize=(15,4))</span>
<span class="n">gini_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1">#gini_df.plot(y=[&#39;Gini&#39;, &#39;T&#39;], figsize=(15,4))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2f60940&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2f8ff98&gt;],
      dtype=object)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_51_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The time paths of the Gini and the Theil coefficients show striking
similarities, and, at first glance, this might suggest that the indices are
substitutes for one another. As we shall see below, however, each index has
properties that lend themselves to particular spatial extensions that provide
important complementarities.</p>
<h2 id="Personal-versus-Regional-Income">Personal versus Regional Income<a class="anchor-link" href="#Personal-versus-Regional-Income"> </a></h2><p>There is a subtle but important distinction between the study of personal and
regional income inequality. To see this, we first need to express the
relationships between the two types of inequality. Consider a country composed
of $N$ individuals who are distributed over $m$ regions. Let $Y_l$ denote the
income of individual $l$. Total personal income in region $i$ is given as $Y_i =
\sum_{l \in i} Y_l$. Per-capita income in region $i$ is $y_i = \frac{Y_i}{N_i}$,
where $N_i$ is the number of individuals in region $i$.</p>
<p>At the national level,  the coefficient of variation as an index of  interpersonal income inequality would be:</p>
$$CV_{nat} = \sqrt{\frac{\sum_{l=1}^N (Y_l - \bar{y})^2}{N}}$$<p>where $\bar{y}$ is national per-capita income. The key component here is the sum
of squares term, and unpacking this sheds light on personal versus regional
inequality question:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$TSS = \sum_{l=1}^N (Y_l - \bar{y})^2$$<p>Focusing on an individual deviation: $\delta_l = Y_l - \bar{y}$, this is the contribution to inequality associated with individual $l$. We can break this into two components:</p>
$$\delta_l = (Y_l - y_i) +  (y_i - \bar{y})$$<p>The first term is the difference between the individual's income and per-capita income in the individual's region of residence, while the second term is the difference between the region's per capita income and average national per capita income.</p>
<p>In regional studies, the intraregional personal income distribution is typically
not available. As a result, the assumption is often made that intraregional
personal inequality is zero. In other words, all individuals in the same region
have identical incomes. With this assumption in hand, the first term vanishes:
$Y_l -y_i = 0$, leading to: <strong>FOOTNOTE:</strong> It should also be noted that even at
the national scale, the analysis of interpersonal income inequality also relies
on aggregate data grouping individuals into income cohorts. See, for example,
Piketty, T. and E. Saez (2003) "Income inequality in the United States,
1913-1998", The Quarterly Journal of Economics, 118: 1-41.</p>
$$
\begin{aligned}
TSS &amp;= \sum_{l=1}^N (Y_l - \bar{y})^2 \\
    &amp;= \sum_{l=1}^N \delta_l^2 \\
    &amp;= \sum_{l=1}^N ((Y_l - y_i) +  (y_i - \bar{y}))^2 \\
    &amp;= \sum_{l=1}^N (0 +  (y_i - \bar{y}))^2 \\
    &amp;= \sum_{i=1}^m\sum_{l \in i}  (y_i - \bar{y})^2 \\
    &amp;= \sum_{i=1}^m  [N_i(y_i - \bar{y})]^2
\end{aligned}
$$<p>This means that each individual in a region has an equal contribution to the
overall level of national interpersonal inequality, given by $(y_i - \bar{y})$,
while the region in question contributes $N_i(y_i - \bar{y})$. While it may seem
that the assumption of zero intraregional interepersonal income inequality is
overly restrictive, it serves to isolate the nature of interregional income
inequality. That is, inequality between places, rather than inequality between
people within those places. In essence, this strategy shifts the question up one
level in the spatial hierarchy by aggregating micro-level individual data to
areal units.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Spatial-Inequality">Spatial Inequality<a class="anchor-link" href="#Spatial-Inequality"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The analysis of regional income inequality is distinguished from the analysis of
national interpersonal income inequality in its focus on spatial units. As
regional incomes are embedded in geographical space, it is important to consider
the special nature of spatial data. In the regional inequality literature this
has been approaches in a number of ways.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Spatial-Autocorrelation">Spatial Autocorrelation<a class="anchor-link" href="#Spatial-Autocorrelation"> </a></h3><p>To get some insights on the spatial properties of regional income data, we can
turn to global measures of spatial autocorrelation that we encountered in
chapter XX. We use a queen spatial weights matrix to calculate Moran's I for
each year in the sample.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span> <span class="o">=</span> <span class="n">pysal</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">Queen</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">pci_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">n</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3077</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">MI</span> <span class="o">=</span> <span class="p">[</span><span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">esda</span><span class="o">.</span><span class="n">moran</span><span class="o">.</span><span class="n">Moran</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)],</span> <span class="n">wq</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">(</span><span class="n">mi</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="n">mi</span><span class="o">.</span><span class="n">p_sim</span><span class="p">)</span> <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="n">MI</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(49, 2)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.64908734, 0.001     ],
       [0.6474407 , 0.001     ],
       [0.62655115, 0.001     ],
       [0.60674267, 0.001     ],
       [0.64021995, 0.001     ],
       [0.62714455, 0.001     ],
       [0.61380412, 0.001     ],
       [0.60599811, 0.001     ],
       [0.61447525, 0.001     ],
       [0.61024325, 0.001     ],
       [0.58338636, 0.001     ],
       [0.59578544, 0.001     ],
       [0.59590793, 0.001     ],
       [0.59042268, 0.001     ],
       [0.56862305, 0.001     ],
       [0.57067704, 0.001     ],
       [0.58410467, 0.001     ],
       [0.59414605, 0.001     ],
       [0.59599186, 0.001     ],
       [0.59763186, 0.001     ],
       [0.585264  , 0.001     ],
       [0.55571103, 0.001     ],
       [0.53596867, 0.001     ],
       [0.52378165, 0.001     ],
       [0.50903512, 0.001     ],
       [0.5143574 , 0.001     ],
       [0.50329369, 0.001     ],
       [0.50819217, 0.001     ],
       [0.50088845, 0.001     ],
       [0.49307704, 0.001     ],
       [0.49635281, 0.001     ],
       [0.50113268, 0.001     ],
       [0.4838774 , 0.001     ],
       [0.48413267, 0.001     ],
       [0.47720078, 0.001     ],
       [0.46154828, 0.001     ],
       [0.43706764, 0.001     ],
       [0.42811594, 0.001     ],
       [0.43908686, 0.001     ],
       [0.43963754, 0.001     ],
       [0.46999904, 0.001     ],
       [0.46676706, 0.001     ],
       [0.48637828, 0.001     ],
       [0.4774375 , 0.001     ],
       [0.47877423, 0.001     ],
       [0.43737008, 0.001     ],
       [0.4337919 , 0.001     ],
       [0.4281568 , 0.001     ],
       [0.4211336 , 0.001     ]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span> <span class="o">=</span> <span class="n">gini_df</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;I pvalue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">res_df</span><span class="p">[[</span><span class="s2">&quot;Gini&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I pvalue&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_63_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Gini&#39;, &#39;T&#39;, &#39;I&#39;, &#39;I pvalue&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Several patterns emerge from the time series of Moran's I. First, the is a secular decline in the value of Moran's I. Second, despite this decline,  there is never a year in which the spatial autocorrelation is not statistically significant. In other words, there is a strong spatial structure in the distribution of regional incomes that needs to be accounted for when focusing on inequality questions.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Decompositional-Approaches">Decompositional Approaches<a class="anchor-link" href="#Decompositional-Approaches"> </a></h3><p>A popular approach to the analysis of inequality is to group the observations into mutually exclusive and exhaustive subsets in order to understand how much of the inequality is due to differences between members of the same subset versus between observations from different subsets. In the personal income literature, the groups have been defined in a number of ways: male vs. female, age cohorts, occupation types, race, etc. In regional applications, small areas are grouped into larger sets such that the resulting sets are spatially defined. <strong>Add notions of connected components here and link to other chapters where appropriate.</strong></p>
<p><!-- #region {"ein.tags": "worksheet-0", "slideshow": {"slide_type": "-"}} --></p>
<h3 id="Regional-Inequality-Decompositions">Regional Inequality Decompositions<a class="anchor-link" href="#Regional-Inequality-Decompositions"> </a></h3><p>One approach to incorporating spatial considerations into regional inequality extends this decompositional approach by using space to define the subgroups. This can be seen using   Theil's $T$, which we encountered previously and decomposing the index  into so called <em>between</em> and <em>within</em> regional inequality components.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applied to a collection of observations on  per capita incomes for $m$ regional economies: $y = \left( y_1, y_2, \ldots, y_m \right)$, which are 
are grouped into $\omega$ mutually exclusive regions such that $\sum_{g=1}^{\omega} m_g=m$, where $m_g$ is the number of areas
assigned to region $g$, Theil's index from above can be rewritten as:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
\begin{align}
T &amp;= \sum_{i=1}^m \left( \frac{y_i}{\sum_{i=1}^m y_i} \ln \left[ m \frac{y_i}{\sum_{i=1}^m y_i}\right] \right) \\
  &amp;= \left[ \sum_{g=1}^{\omega} s_{g} log(\frac{m}{m_g} s_g)  \right] + \left[ \sum_{g=1}^{\omega} s_g \sum_{i \in g} s_{i,g} log(m_g s_{i,g}) \right] \\
  &amp;= B + W \\
\end{align}
$$<p>where $s_g = \frac{\sum_{i \in g} y_i}{\sum_i y_i}$, and   $s_{i,g} = y_i / \sum_{i \in g} y_i$.</p>
<p>The first term is the between regions inequality component, and the second is the within regions inequality component.
The within region term is a weighted average of inequality between economies belonging to the same region.
Similar to what is done above for the case of interpersonal inequality, the
estimate of the between region (group) component of the decomposition is based on
setting the incomes of all economies (individuals )belonging to a region (group) equal to that of the
regional (group) average of these per capita incomes. Now, however, intraregional
inequality between economies within the same region is explicitly considered in
the second  component.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note:</strong> The regional decomposition does not involve weighting the regions by their respective population. See  <a href="https://webvpn.ucr.edu/+CSCO+0075676763663A2F2F6A6A6A2E676E6171736261797661722E70627A++/doi/full/10.1080/17421772.2017.1343491">Gluschenko (2018)</a> for further details.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;1969&#39;, &#39;1970&#39;, &#39;1971&#39;, &#39;1972&#39;, &#39;1973&#39;, &#39;1974&#39;, &#39;1975&#39;, &#39;1976&#39;, &#39;1977&#39;,
       &#39;1978&#39;, &#39;1979&#39;, &#39;1980&#39;, &#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;, &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;,
       &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;, &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;,
       &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;, &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;,
       &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;, &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;,
       &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;2017&#39;, &#39;ALAND&#39;, &#39;AWATER&#39;, &#39;CBSAFP&#39;, &#39;CLASSFP&#39;,
       &#39;COUNTYFP&#39;, &#39;COUNTYNS&#39;, &#39;CSAFP&#39;, &#39;Descriptio&#39;, &#39;Descript_1&#39;, &#39;FUNCSTAT&#39;,
       &#39;GEOID&#39;, &#39;GeoFIPS&#39;, &#39;GeoName&#39;, &#39;INTPTLAT&#39;, &#39;INTPTLON&#39;, &#39;IndustryCl&#39;,
       &#39;LSAD&#39;, &#39;LineCode&#39;, &#39;METDIVFP&#39;, &#39;MTFCC&#39;, &#39;NAME&#39;, &#39;NAMELSAD&#39;, &#39;Region&#39;,
       &#39;STATEFP&#39;, &#39;TableName&#39;, &#39;Unit&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([3, 5, 8, 1, 2, 7, 4, 6])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2f51ef0&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_72_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_df</span> <span class="o">=</span> <span class="n">pci_df</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">region_df</span><span class="o">.</span><span class="n">Region</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([5, 6, 8, 7, 1, 2, 3, 4])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2f64ac8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_75_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">pci_df</span><span class="p">[</span><span class="n">pci_df</span><span class="o">.</span><span class="n">Region</span><span class="o">==</span><span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_0.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_1.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_2.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_3.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_4.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_5.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_6.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_76_7.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;New England&quot;</span><span class="p">,</span>
               <span class="s1">&#39;Mideast&#39;</span><span class="p">,</span> <span class="s1">&#39;Great Lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;Plains&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Southeast&#39;</span><span class="p">,</span> <span class="s1">&#39;Southwest&#39;</span><span class="p">,</span> <span class="s1">&#39;Rocky Mountain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Far West&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pci_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>1970</th>
      <th>1971</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>...</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>LineCode</th>
    </tr>
    <tr>
      <th>Region</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3736.208955</td>
      <td>3984.611940</td>
      <td>4238.238806</td>
      <td>4567.477612</td>
      <td>4959.328358</td>
      <td>5338.358209</td>
      <td>5740.134328</td>
      <td>6333.537313</td>
      <td>6846.955224</td>
      <td>7585.776119</td>
      <td>...</td>
      <td>46358.701493</td>
      <td>48058.731343</td>
      <td>48107.701493</td>
      <td>50086.671642</td>
      <td>52201.611940</td>
      <td>53493.805970</td>
      <td>55414.552239</td>
      <td>2.423518e+09</td>
      <td>3.592977e+08</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3745.112360</td>
      <td>4003.943820</td>
      <td>4263.578652</td>
      <td>4608.359551</td>
      <td>5073.617978</td>
      <td>5534.668539</td>
      <td>5994.792135</td>
      <td>6485.730337</td>
      <td>7042.426966</td>
      <td>7773.331461</td>
      <td>...</td>
      <td>41977.707865</td>
      <td>43304.949438</td>
      <td>43733.797753</td>
      <td>45401.174157</td>
      <td>47022.191011</td>
      <td>47930.286517</td>
      <td>49987.123596</td>
      <td>1.614247e+09</td>
      <td>1.943027e+08</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3426.800459</td>
      <td>3575.077982</td>
      <td>3863.880734</td>
      <td>4199.541284</td>
      <td>4795.082569</td>
      <td>5156.715596</td>
      <td>5668.309633</td>
      <td>6146.045872</td>
      <td>6720.729358</td>
      <td>7398.935780</td>
      <td>...</td>
      <td>35712.176606</td>
      <td>36784.635321</td>
      <td>37842.667431</td>
      <td>38810.309633</td>
      <td>39864.006881</td>
      <td>40735.772936</td>
      <td>41918.071101</td>
      <td>1.441214e+09</td>
      <td>3.468585e+08</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3185.181230</td>
      <td>3463.689320</td>
      <td>3748.909385</td>
      <td>4273.289644</td>
      <td>5462.899676</td>
      <td>5389.299353</td>
      <td>5774.113269</td>
      <td>5824.689320</td>
      <td>6299.959547</td>
      <td>7291.336570</td>
      <td>...</td>
      <td>41725.169903</td>
      <td>43098.207120</td>
      <td>44535.634304</td>
      <td>44770.778317</td>
      <td>44949.200647</td>
      <td>44198.533981</td>
      <td>44367.509709</td>
      <td>2.127329e+09</td>
      <td>5.344987e+07</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2611.941120</td>
      <td>2829.420849</td>
      <td>3062.441120</td>
      <td>3388.722008</td>
      <td>3834.005792</td>
      <td>4188.248069</td>
      <td>4487.643822</td>
      <td>4969.812741</td>
      <td>5389.917954</td>
      <td>6048.381274</td>
      <td>...</td>
      <td>31797.827220</td>
      <td>32858.700772</td>
      <td>33237.038610</td>
      <td>34312.055985</td>
      <td>35483.079151</td>
      <td>36018.351351</td>
      <td>37216.367761</td>
      <td>1.302386e+09</td>
      <td>9.926782e+07</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2968.305040</td>
      <td>3233.893899</td>
      <td>3443.859416</td>
      <td>3835.867374</td>
      <td>4486.610080</td>
      <td>4565.095491</td>
      <td>5182.435013</td>
      <td>5621.554377</td>
      <td>6045.092838</td>
      <td>6710.564987</td>
      <td>...</td>
      <td>35886.458886</td>
      <td>37412.612732</td>
      <td>38892.190981</td>
      <td>41058.530504</td>
      <td>40829.559682</td>
      <td>39043.450928</td>
      <td>40153.835544</td>
      <td>3.842122e+09</td>
      <td>6.343465e+07</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3320.837209</td>
      <td>3642.600000</td>
      <td>3869.986047</td>
      <td>4407.576744</td>
      <td>5147.102326</td>
      <td>5597.353488</td>
      <td>5814.697674</td>
      <td>6090.674419</td>
      <td>6506.418605</td>
      <td>7408.781395</td>
      <td>...</td>
      <td>37304.758140</td>
      <td>39290.641860</td>
      <td>40389.246512</td>
      <td>42126.865116</td>
      <td>43665.418605</td>
      <td>43188.325581</td>
      <td>44321.232558</td>
      <td>6.158906e+09</td>
      <td>7.368098e+07</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4026.353333</td>
      <td>4282.726667</td>
      <td>4605.933333</td>
      <td>5058.586667</td>
      <td>5621.780000</td>
      <td>6265.166667</td>
      <td>6749.706667</td>
      <td>7185.206667</td>
      <td>7694.146667</td>
      <td>8605.840000</td>
      <td>...</td>
      <td>38548.673333</td>
      <td>39962.253333</td>
      <td>40579.226667</td>
      <td>42877.700000</td>
      <td>45247.820000</td>
      <td>46248.953333</td>
      <td>47928.013333</td>
      <td>7.392819e+09</td>
      <td>2.725763e+08</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 52 columns</p>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regimes</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Time-series-plot-of-the-regional-means-(WIP)">Time series plot of the regional means (WIP)<a class="anchor-link" href="#Time-series-plot-of-the-regional-means-(WIP)"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span> <span class="o">=</span> <span class="n">pci_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(52, 8)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Int64Index([1, 2, 3, 4, 5, 6, 7, 8], dtype=&#39;int64&#39;, name=&#39;Region&#39;)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_dr</span> <span class="o">=</span> <span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">TheilD</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">regimes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_dr</span><span class="o">.</span><span class="n">bg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.00913759, 0.00822371, 0.00782508, 0.00767872, 0.01022404,
       0.00812432, 0.00783763, 0.00572192, 0.00559778, 0.00549276,
       0.00511292, 0.00565294, 0.00486341, 0.00465598, 0.00473723,
       0.00423896, 0.00427742, 0.00452794, 0.00465081, 0.0045606 ,
       0.00466703, 0.00411722, 0.00365779, 0.00341614, 0.00326612,
       0.00312039, 0.00325658, 0.00359213, 0.00326984, 0.00362352,
       0.00381669, 0.00435476, 0.00398438, 0.00401826, 0.00396334,
       0.00394126, 0.00352894, 0.00362163, 0.00399958, 0.00449142,
       0.00434706, 0.00470395, 0.006389  , 0.0064173 , 0.00693559,
       0.00644317, 0.00591177, 0.00553469, 0.00528127])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theil_dr</span><span class="o">.</span><span class="n">bg</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;wgr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theil_dr</span><span class="o">.</span><span class="n">wg</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2d6a208&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2d9bdd8&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2f41f98&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2dbff60&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2db4eb8&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2db9978&gt;],
      dtype=object)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_87_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">theil_drs</span> <span class="o">=</span> <span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">TheilDSim</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">regimes</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgr_pvalue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theil_drs</span><span class="o">.</span><span class="n">bg_pvalue</span>
<span class="n">res_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2d42860&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2eafc50&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2da66a0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2e26240&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2dbc4e0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2f33da0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2ee3240&gt;],
      dtype=object)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_89_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgr_share&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgr&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgr_share&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2d6d2e8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_90_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Decomposition-Using-States">Decomposition Using States<a class="anchor-link" href="#Decomposition-Using-States"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span> <span class="o">=</span> <span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">TheilD</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.02956245, 0.0272826 , 0.0267571 , 0.02732865, 0.03318841,
       0.02837545, 0.0281248 , 0.02220418, 0.02214208, 0.02139889,
       0.02188909, 0.02481497, 0.02220707, 0.02231055, 0.02363097,
       0.02279176, 0.02316332, 0.0236385 , 0.023731  , 0.02526223,
       0.02380102, 0.02356529, 0.02206142, 0.02089816, 0.02176745,
       0.02056457, 0.0220403 , 0.02280536, 0.02295407, 0.02473368,
       0.02590107, 0.02772869, 0.0262756 , 0.02559157, 0.02485007,
       0.02540392, 0.02704911, 0.03096952, 0.0308576 , 0.03143146,
       0.02556138, 0.02711406, 0.03202027, 0.03473141, 0.03452092,
       0.03544577, 0.03392023, 0.03175856, 0.03098273])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.01202405, 0.01098113, 0.01061615, 0.01071169, 0.01460935,
       0.01174436, 0.01105702, 0.00815238, 0.00775735, 0.00776747,
       0.00712734, 0.00872468, 0.00756751, 0.00769704, 0.00793969,
       0.00740442, 0.00760461, 0.00797024, 0.00823797, 0.00882368,
       0.00822786, 0.00749844, 0.00647532, 0.00599946, 0.00588982,
       0.00554082, 0.00588671, 0.00611632, 0.00609094, 0.00646917,
       0.00697235, 0.00771176, 0.00735026, 0.00735872, 0.00738993,
       0.00719819, 0.00701849, 0.00759005, 0.00812707, 0.00871506,
       0.0079286 , 0.00889664, 0.01146386, 0.01226537, 0.01195608,
       0.01128462, 0.01076572, 0.00978201, 0.00924145])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgs_share&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span> <span class="o">/</span> <span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;bgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[[</span><span class="s1">&#39;bgr&#39;</span><span class="p">,</span> <span class="s1">&#39;bgs&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2f6a898&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_96_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[[</span><span class="s1">&#39;bgr_share&#39;</span><span class="p">,</span> <span class="s1">&#39;bgs_share&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2c98710&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_97_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[[</span><span class="s1">&#39;bgr_share&#39;</span><span class="p">,</span> <span class="s1">&#39;bgs_share&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bgr_share</th>
      <th>bgs_share</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bgr_share</th>
      <td>1.000000</td>
      <td>0.942285</td>
      <td>0.057848</td>
    </tr>
    <tr>
      <th>bgs_share</th>
      <td>0.942285</td>
      <td>1.000000</td>
      <td>0.183847</td>
    </tr>
    <tr>
      <th>T</th>
      <td>0.057848</td>
      <td>0.183847</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>inequality between the states is larger than inequality between regions</li>
<li>inequality within states is smaller than inequality within regions</li>
<li>time series of the between component are similar for regional and state partitions of the counties</li>
<li>correlation of between share and overall inequality is higher at the state level than the region level</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intraregional-inequality-trends">Intraregional inequality trends<a class="anchor-link" href="#Intraregional-inequality-trends"> </a></h3><p>Theil applied to each of the regions.</p>
<p>Plot the eight series</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2e064a8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_101_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">rdf</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="n">pci_df</span><span class="o">.</span><span class="n">Region</span><span class="o">==</span><span class="n">i</span><span class="p">]</span>
    <span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_102_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;New England&quot;</span><span class="p">,</span>
               <span class="s1">&#39;Mideast&#39;</span><span class="p">,</span> <span class="s1">&#39;Great Lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;Plains&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Southeast&#39;</span><span class="p">,</span> <span class="s1">&#39;Southwest&#39;</span><span class="p">,</span> <span class="s1">&#39;Rocky Mountain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Far West&#39;</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">rdf</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="n">pci_df</span><span class="o">.</span><span class="n">Region</span><span class="o">==</span><span class="n">region</span><span class="p">]</span>
    <span class="c1">#rdf.plot()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">)),</span> <span class="n">rdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">region</span><span class="p">,</span> <span class="n">region_names</span><span class="p">[</span><span class="n">region</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">)),</span> <span class="n">rdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="c1">#results.append(pysal.explore.inequality.theil.TheilDSim(rdf[ys].values, rdf.STATEFP,999))</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 6 67
2 6 178
3 5 436
4 7 618
5 12 1036
6 4 377
7 5 215
8 4 150
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>New England</td>
      <td>6</td>
      <td>67</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mideast</td>
      <td>6</td>
      <td>178</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Great Lakes</td>
      <td>5</td>
      <td>436</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Plains</td>
      <td>7</td>
      <td>618</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Southeast</td>
      <td>12</td>
      <td>1036</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Southwest</td>
      <td>4</td>
      <td>377</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>Rocky Mountain</td>
      <td>5</td>
      <td>215</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>Far West</td>
      <td>4</td>
      <td>150</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Region&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;States&quot;</span><span class="p">,</span> <span class="s2">&quot;Counties&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Name</th>
      <th>States</th>
      <th>Counties</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>New England</td>
      <td>6</td>
      <td>67</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mideast</td>
      <td>6</td>
      <td>178</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Great Lakes</td>
      <td>5</td>
      <td>436</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Plains</td>
      <td>7</td>
      <td>618</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Southeast</td>
      <td>12</td>
      <td>1036</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Southwest</td>
      <td>4</td>
      <td>377</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>Rocky Mountain</td>
      <td>5</td>
      <td>215</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>Far West</td>
      <td>4</td>
      <td>150</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intra-regional-inequality">Intra regional inequality<a class="anchor-link" href="#Intra-regional-inequality"> </a></h3><p>We can take a closer look at the within region inequality component by dissagregating the total value from XX into that occuring within each of the 8 regions. This can be done by calculating the global Theil index on the counties belonging to a given region.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;New England&quot;</span><span class="p">,</span>
               <span class="s1">&#39;Mideast&#39;</span><span class="p">,</span> <span class="s1">&#39;Great Lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;Plains&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Southeast&#39;</span><span class="p">,</span> <span class="s1">&#39;Southwest&#39;</span><span class="p">,</span> <span class="s1">&#39;Rocky Mountain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Far West&#39;</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">rdf</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="n">pci_df</span><span class="o">.</span><span class="n">Region</span><span class="o">==</span><span class="n">region</span><span class="p">]</span>
    <span class="c1">#rdf.plot()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">)),</span> <span class="n">rdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">region</span><span class="p">,</span> <span class="n">region_names</span><span class="p">[</span><span class="n">region</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">)),</span> <span class="n">rdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">TheilDSim</span><span class="p">(</span><span class="n">rdf</span><span class="p">[</span><span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 6 67
2 6 178
3 5 436
4 7 618
5 12 1036
6 4 377
7 5 215
8 4 150
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r1</span><span class="o">.</span><span class="n">bg_pvalue</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
       0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
       0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
       0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
       0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
       0.001, 0.001, 0.001, 0.001])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r1</span><span class="o">.</span><span class="n">bg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.00905797, 0.00793991, 0.00784536, ..., 0.0142647 , 0.01453823,
        0.01478042],
       [0.00069922, 0.00060126, 0.00061298, ..., 0.00140586, 0.00143189,
        0.00147293],
       [0.00099987, 0.0009492 , 0.00071565, ..., 0.00118387, 0.00117219,
        0.00119068],
       ...,
       [0.00098307, 0.00090302, 0.00094634, ..., 0.00249735, 0.00252576,
        0.00247384],
       [0.00051996, 0.00047563, 0.00044819, ..., 0.00236406, 0.00251486,
        0.00250307],
       [0.00258669, 0.0023153 , 0.00231772, ..., 0.00560273, 0.00563963,
        0.00574243]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tr</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.014585</td>
      <td>0.018776</td>
      <td>0.012075</td>
      <td>0.015233</td>
      <td>0.028101</td>
      <td>0.029590</td>
      <td>0.018616</td>
      <td>0.013005</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.013423</td>
      <td>0.018680</td>
      <td>0.010455</td>
      <td>0.015837</td>
      <td>0.024661</td>
      <td>0.025866</td>
      <td>0.020219</td>
      <td>0.013539</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.013806</td>
      <td>0.019843</td>
      <td>0.010493</td>
      <td>0.014355</td>
      <td>0.024532</td>
      <td>0.027463</td>
      <td>0.018711</td>
      <td>0.014485</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.014890</td>
      <td>0.019747</td>
      <td>0.010600</td>
      <td>0.016188</td>
      <td>0.023113</td>
      <td>0.032705</td>
      <td>0.019762</td>
      <td>0.014310</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.012113</td>
      <td>0.017861</td>
      <td>0.011965</td>
      <td>0.027926</td>
      <td>0.020512</td>
      <td>0.038443</td>
      <td>0.027356</td>
      <td>0.014854</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;New England&quot;</span><span class="p">,</span>
               <span class="s1">&#39;Mideast&#39;</span><span class="p">,</span> <span class="s1">&#39;Great Lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;Plains&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Southeast&#39;</span><span class="p">,</span> <span class="s1">&#39;Southwest&#39;</span><span class="p">,</span> <span class="s1">&#39;Rocky Mountain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Far West&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tr</span> <span class="o">=</span> <span class="n">Tr</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">dict</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">region_names</span><span class="p">)]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pinned0</span> <span class="o">=</span> <span class="n">Tr</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">Tr</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pinned0</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()):</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_marker</span><span class="p">(</span><span class="n">markers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># for adding legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x7fc8c2e9e710&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_118_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unpacking the intraregional inequality term reveals that the original decomposition of inequality into within and between regions actually masks a great deal of heterogeneity in the internal inequality dynamics across the eight regions. Put another way, the overall trend in the aggregate within region component above is an average of the trends exhibited in each of the eight regions. There are two distinct groups of regions in this regard. The first consists of regions where the inequality between counties within each region has been increasing over the sample period. This group is composed of the New England,  Mideast, Far West, and Rocky Mountains regions. The second group are those regions where intraregional inequality has remained stable, or even decreased, over time. The Great Lakes, Southeast, and Southwest regions compose this group. The one outlier region is the Plains which does not fall neatly into either of these two groups.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span> <span class="o">=</span> <span class="n">pysal</span><span class="o">.</span><span class="n">explore</span><span class="o">.</span><span class="n">inequality</span><span class="o">.</span><span class="n">theil</span><span class="o">.</span><span class="n">TheilDSim</span><span class="p">(</span><span class="n">rdf</span><span class="p">[</span><span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>49</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.00295158, 0.0027086 , 0.00279838, 0.00211417, 0.00204306,
       0.00037282, 0.00034725, 0.00057796, 0.00102812, 0.00107788,
       0.00067789, 0.00117061, 0.00168775, 0.00206328, 0.00127034,
       0.00148108, 0.00192297, 0.00159865, 0.00257352, 0.00298896,
       0.00259718, 0.00202416, 0.00198901, 0.00166313, 0.00129544,
       0.00149066, 0.00133233, 0.0010449 , 0.00123431, 0.00191652,
       0.00289866, 0.00327374, 0.00390488, 0.00374813, 0.00335202,
       0.00368984, 0.0040759 , 0.00424701, 0.00362028, 0.00255708,
       0.00236641, 0.00293262, 0.00311549, 0.00316963, 0.00357701,
       0.00390474, 0.00433766, 0.00511215, 0.00540712])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">bg_pvalue</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.001, 0.001, 0.001, 0.001, 0.001, 0.498, 0.414, 0.043, 0.002,
       0.002, 0.029, 0.009, 0.001, 0.001, 0.015, 0.006, 0.001, 0.006,
       0.001, 0.001, 0.001, 0.001, 0.002, 0.005, 0.017, 0.012, 0.043,
       0.1  , 0.081, 0.031, 0.007, 0.008, 0.001, 0.001, 0.002, 0.001,
       0.001, 0.001, 0.005, 0.016, 0.007, 0.002, 0.002, 0.004, 0.003,
       0.002, 0.002, 0.002, 0.002])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.01300504, 0.01353897, 0.01448477, 0.0143102 , 0.01485378,
       0.02057958, 0.01640312, 0.009388  , 0.00906217, 0.01087958,
       0.01032465, 0.01379389, 0.0135445 , 0.01424603, 0.01594675,
       0.01540832, 0.01594909, 0.0165648 , 0.01621477, 0.01708498,
       0.01630393, 0.01671203, 0.0174846 , 0.01721203, 0.01670732,
       0.01833721, 0.02040777, 0.02151451, 0.02337549, 0.02726335,
       0.03177261, 0.03712272, 0.03531719, 0.0312238 , 0.02848151,
       0.03035599, 0.03326946, 0.03735221, 0.03482165, 0.03122007,
       0.02568502, 0.0258377 , 0.02789644, 0.03168081, 0.03059115,
       0.03167113, 0.03345198, 0.03562125, 0.03725178])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">bg</span><span class="o">/</span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.22695684, 0.20005983, 0.19319448, ..., 0.12966837, 0.14351415,
        0.14515059],
       [0.01706968, 0.00984034, 0.00380051, ..., 0.01280664, 0.01259456,
        0.01206383],
       [0.02823692, 0.01668119, 0.01187254, ..., 0.01333787, 0.01275938,
        0.01212704],
       ...,
       [0.01080717, 0.01696786, 0.01089573, ..., 0.01250036, 0.01580922,
        0.01574904],
       [0.03620417, 0.03990198, 0.02734309, ..., 0.06413847, 0.06259696,
        0.06532176],
       [0.03414419, 0.03321956, 0.03178242, ..., 0.02971032, 0.0285123 ,
        0.02808748]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wgp_ds</span> <span class="o">=</span> <span class="n">theil_ds</span><span class="o">.</span><span class="n">wg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wgp_dr</span> <span class="o">=</span> <span class="n">theil_ds</span><span class="o">.</span><span class="n">wg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wgp_dr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(49,)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(49, 10)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wgp_ds</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;wgp_ds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wgp_ds</span>
<span class="n">wgp_dr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;wgp_dr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wgp_dr</span>

<span class="n">res_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2bf73c8&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c1ceb8&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c23ef0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c21e48&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c3ef60&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c39f98&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c4afd0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c45f60&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2b97f28&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2c3a0b8&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2b070f0&gt;,
       &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fc8c2afb128&gt;],
      dtype=object)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_130_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wgp_ds&#39;</span><span class="p">,</span><span class="s1">&#39;wgp_dr&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2ba2be0&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_131_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gini</th>
      <th>T</th>
      <th>I</th>
      <th>I pvalue</th>
      <th>bgr</th>
      <th>wgr</th>
      <th>bgr_pvalue</th>
      <th>bgr_share</th>
      <th>bgs_share</th>
      <th>bgs</th>
      <th>wgp_ds</th>
      <th>wgp_dr</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1969-01-01</th>
      <td>0.135537</td>
      <td>0.029562</td>
      <td>0.649087</td>
      <td>0.001</td>
      <td>0.009138</td>
      <td>0.020425</td>
      <td>0.001</td>
      <td>0.309095</td>
      <td>0.406734</td>
      <td>0.012024</td>
      <td>0.773043</td>
      <td>0.773043</td>
    </tr>
    <tr>
      <th>1970-01-01</th>
      <td>0.130055</td>
      <td>0.027283</td>
      <td>0.647441</td>
      <td>0.001</td>
      <td>0.008224</td>
      <td>0.019059</td>
      <td>0.001</td>
      <td>0.301427</td>
      <td>0.402496</td>
      <td>0.010981</td>
      <td>0.799940</td>
      <td>0.799940</td>
    </tr>
    <tr>
      <th>1971-01-01</th>
      <td>0.128522</td>
      <td>0.026757</td>
      <td>0.626551</td>
      <td>0.001</td>
      <td>0.007825</td>
      <td>0.018932</td>
      <td>0.001</td>
      <td>0.292449</td>
      <td>0.396760</td>
      <td>0.010616</td>
      <td>0.806806</td>
      <td>0.806806</td>
    </tr>
    <tr>
      <th>1972-01-01</th>
      <td>0.129104</td>
      <td>0.027329</td>
      <td>0.606743</td>
      <td>0.001</td>
      <td>0.007679</td>
      <td>0.019650</td>
      <td>0.001</td>
      <td>0.280977</td>
      <td>0.391958</td>
      <td>0.010712</td>
      <td>0.852261</td>
      <td>0.852261</td>
    </tr>
    <tr>
      <th>1973-01-01</th>
      <td>0.142146</td>
      <td>0.033188</td>
      <td>0.640220</td>
      <td>0.001</td>
      <td>0.010224</td>
      <td>0.022964</td>
      <td>0.001</td>
      <td>0.308061</td>
      <td>0.440194</td>
      <td>0.014609</td>
      <td>0.862455</td>
      <td>0.862455</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.01300504, 0.01353897, 0.01448477, 0.0143102 , 0.01485378,
       0.02057958, 0.01640312, 0.009388  , 0.00906217, 0.01087958,
       0.01032465, 0.01379389, 0.0135445 , 0.01424603, 0.01594675,
       0.01540832, 0.01594909, 0.0165648 , 0.01621477, 0.01708498,
       0.01630393, 0.01671203, 0.0174846 , 0.01721203, 0.01670732,
       0.01833721, 0.02040777, 0.02151451, 0.02337549, 0.02726335,
       0.03177261, 0.03712272, 0.03531719, 0.0312238 , 0.02848151,
       0.03035599, 0.03326946, 0.03735221, 0.03482165, 0.03122007,
       0.02568502, 0.0258377 , 0.02789644, 0.03168081, 0.03059115,
       0.03167113, 0.03345198, 0.03562125, 0.03725178])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theil_ds</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.01300504, 0.01353897, 0.01448477, 0.0143102 , 0.01485378,
       0.02057958, 0.01640312, 0.009388  , 0.00906217, 0.01087958,
       0.01032465, 0.01379389, 0.0135445 , 0.01424603, 0.01594675,
       0.01540832, 0.01594909, 0.0165648 , 0.01621477, 0.01708498,
       0.01630393, 0.01671203, 0.0174846 , 0.01721203, 0.01670732,
       0.01833721, 0.02040777, 0.02151451, 0.02337549, 0.02726335,
       0.03177261, 0.03712272, 0.03531719, 0.0312238 , 0.02848151,
       0.03035599, 0.03326946, 0.03735221, 0.03482165, 0.03122007,
       0.02568502, 0.0258377 , 0.02789644, 0.03168081, 0.03059115,
       0.03167113, 0.03345198, 0.03562125, 0.03725178])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- #region {"ein.tags": "worksheet-0", "slideshow": {"slide_type": "-"}} -->


<h3 id="Spatializing-Classic-Measures">Spatializing Classic Measures<a class="anchor-link" href="#Spatializing-Classic-Measures"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now turn to two newer spatial analytics that extend a selction of the classic (a-spatial) inequality measures above to introduce a spatially explicit focus.</p>
<h4 id="Spatial-Gini">Spatial Gini<a class="anchor-link" href="#Spatial-Gini"> </a></h4><p>The first spatial extension was introduced by Rey and Smith (2013) and is designed to consider the role of adjacency in a decomposition of the Gini index of inequality. More specifically, The Gini in mean xxx is rewritten.</p>
<ul>
<li>point out theil decomposition ignores spatial interactions between counties, both within a region and between region</li>
<li>spatial gini as a complement</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pysal.explore.inequality.gini</span> <span class="kn">import</span> <span class="n">Gini_Spatial</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">pct_nonzero</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.19389668004481234</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">s0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18358.0</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">wq</span><span class="o">.</span><span class="n">n</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9467929</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">n</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3077</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">wq</span><span class="o">.</span><span class="n">full</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18358.0</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">9467929</span> <span class="o">*</span> <span class="n">wq</span><span class="o">.</span><span class="n">pct_nonzero</span> <span class="o">/</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18358.0</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">18358</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9179.0</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wq</span><span class="o">.</span><span class="n">histogram</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(1, 2),
 (2, 10),
 (3, 62),
 (4, 256),
 (5, 679),
 (6, 1104),
 (7, 680),
 (8, 229),
 (9, 43),
 (10, 9),
 (11, 1),
 (12, 0),
 (13, 1),
 (14, 1)]</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wq</span><span class="o">.</span><span class="n">histogram</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">hist</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">hist</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18358</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs69</span> <span class="o">=</span> <span class="n">Gini_Spatial</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="s1">&#39;1969&#39;</span><span class="p">],</span> <span class="n">wq</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs69</span><span class="o">.</span><span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.13553708123000455</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs69</span><span class="o">.</span><span class="n">p_sim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.01</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Gini_Spatial</span><span class="p">(</span><span class="n">pci_df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">wq</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">gsi</span><span class="o">.</span><span class="n">e_wcg</span><span class="p">,</span> <span class="n">gsi</span><span class="o">.</span><span class="n">wcg</span><span class="p">,</span> <span class="n">gsi</span><span class="o">.</span><span class="n">z_wcg</span><span class="p">,</span> <span class="n">gsi</span><span class="o">.</span><span class="n">p_sim</span><span class="p">)</span> <span class="k">for</span> <span class="n">gsi</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs_array</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[7.92720475e+09, 7.93416705e+09, 7.77712626e+01, 1.00000000e-02],
       [8.19177428e+09, 8.19877831e+09, 6.62890115e+01, 1.00000000e-02],
       [8.71357593e+09, 8.72084736e+09, 6.68513380e+01, 1.00000000e-02],
       [9.72292997e+09, 9.73123725e+09, 6.24446900e+01, 1.00000000e-02],
       [1.24984269e+10, 1.25099023e+10, 9.20396338e+01, 1.00000000e-02],
       [1.21285827e+10, 1.21390126e+10, 6.47767593e+01, 1.00000000e-02],
       [1.31102701e+10, 1.31213918e+10, 6.99085227e+01, 1.00000000e-02],
       [1.26275073e+10, 1.26375368e+10, 8.28880935e+01, 1.00000000e-02],
       [1.36727181e+10, 1.36834255e+10, 6.02483350e+01, 1.00000000e-02],
       [1.50925337e+10, 1.51044382e+10, 6.25363962e+01, 1.00000000e-02],
       [1.67647183e+10, 1.67775021e+10, 5.96736128e+01, 1.00000000e-02],
       [1.91347322e+10, 1.91493549e+10, 5.83239879e+01, 1.00000000e-02],
       [2.05396521e+10, 2.05555047e+10, 6.19928656e+01, 1.00000000e-02],
       [2.17375545e+10, 2.17543710e+10, 5.68741903e+01, 1.00000000e-02],
       [2.32562941e+10, 2.32734932e+10, 6.05912537e+01, 1.00000000e-02],
       [2.51406116e+10, 2.51596831e+10, 5.27682970e+01, 1.00000000e-02],
       [2.66166001e+10, 2.66369335e+10, 6.48278472e+01, 1.00000000e-02],
       [2.79077957e+10, 2.79295494e+10, 6.54139802e+01, 1.00000000e-02],
       [2.91998520e+10, 2.92226532e+10, 7.25401140e+01, 1.00000000e-02],
       [3.15443859e+10, 3.15684580e+10, 6.22882711e+01, 1.00000000e-02],
       [3.28988029e+10, 3.29235470e+10, 5.79784961e+01, 1.00000000e-02],
       [3.44009482e+10, 3.44258176e+10, 5.20481808e+01, 1.00000000e-02],
       [3.39371201e+10, 3.39600008e+10, 4.76869032e+01, 1.00000000e-02],
       [3.50414658e+10, 3.50650377e+10, 4.62961362e+01, 1.00000000e-02],
       [3.69224834e+10, 3.69463551e+10, 5.12236686e+01, 1.00000000e-02],
       [3.75500346e+10, 3.75747712e+10, 4.92479182e+01, 1.00000000e-02],
       [3.98009812e+10, 3.98259896e+10, 5.13241933e+01, 1.00000000e-02],
       [4.32118069e+10, 4.32406756e+10, 5.40594872e+01, 1.00000000e-02],
       [4.47928693e+10, 4.48220648e+10, 5.65264527e+01, 1.00000000e-02],
       [4.88959012e+10, 4.89275190e+10, 5.32557338e+01, 1.00000000e-02],
       [5.15135214e+10, 5.15470570e+10, 4.81166130e+01, 1.00000000e-02],
       [5.58879609e+10, 5.59250944e+10, 5.05441781e+01, 1.00000000e-02],
       [5.68675677e+10, 5.69040667e+10, 5.06700252e+01, 1.00000000e-02],
       [5.64942343e+10, 5.65293597e+10, 4.64492829e+01, 1.00000000e-02],
       [5.88375461e+10, 5.88749548e+10, 5.21953681e+01, 1.00000000e-02],
       [6.15490640e+10, 6.15882825e+10, 4.47866594e+01, 1.00000000e-02],
       [6.55482075e+10, 6.55879628e+10, 4.48871829e+01, 1.00000000e-02],
       [7.22578323e+10, 7.23002626e+10, 3.75765359e+01, 1.00000000e-02],
       [7.74095270e+10, 7.74575565e+10, 4.92671046e+01, 1.00000000e-02],
       [8.32339322e+10, 8.32874943e+10, 4.20144107e+01, 1.00000000e-02],
       [7.36753357e+10, 7.37229102e+10, 4.98694737e+01, 1.00000000e-02],
       [7.86360960e+10, 7.86882818e+10, 4.83098855e+01, 1.00000000e-02],
       [9.27763881e+10, 9.28416547e+10, 5.08213237e+01, 1.00000000e-02],
       [9.88681041e+10, 9.89376274e+10, 4.66305030e+01, 1.00000000e-02],
       [1.01516755e+11, 1.01588954e+11, 5.15091727e+01, 1.00000000e-02],
       [1.04564296e+11, 1.04634485e+11, 4.74811141e+01, 1.00000000e-02],
       [1.04749598e+11, 1.04818698e+11, 4.71314551e+01, 1.00000000e-02],
       [1.01009872e+11, 1.01076094e+11, 4.11513666e+01, 1.00000000e-02],
       [1.01488480e+11, 1.01553764e+11, 4.31770937e+01, 1.00000000e-02]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs69</span><span class="o">.</span><span class="n">wcg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>7934167045.999999</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;z_wcg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gs_array</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">res_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z_wcg&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2ca3f28&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_157_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Spatial-20:20">Spatial 20:20<a class="anchor-link" href="#Spatial-20:20"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ranks</span> <span class="o">=</span> <span class="n">pci_df</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">pci_df</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_rank&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pci_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ridx_20</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3077</span><span class="p">)</span>
<span class="n">ridx_80</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="o">.</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">3077</span><span class="p">)</span>
<span class="n">ridx_20</span><span class="p">,</span> <span class="n">ridx_80</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(615, 2461)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pci_df</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;1969_rank&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0       2691.0
1       2209.0
2       1972.0
3       1040.0
4        992.0
         ...  
3072    1599.0
3073    3020.0
3074     635.0
3075    1925.0
3076    2849.0
Name: 1969_rank, Length: 3077, dtype: float64</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;1969_rank&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">615</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>1970</th>
      <th>1971</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>...</th>
      <th>2008_rank</th>
      <th>2009_rank</th>
      <th>2010_rank</th>
      <th>2011_rank</th>
      <th>2012_rank</th>
      <th>2013_rank</th>
      <th>2014_rank</th>
      <th>2015_rank</th>
      <th>2016_rank</th>
      <th>2017_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2999</th>
      <td>2444</td>
      <td>2562</td>
      <td>2719</td>
      <td>3015</td>
      <td>3241</td>
      <td>3665</td>
      <td>4208</td>
      <td>4881</td>
      <td>5581</td>
      <td>6407</td>
      <td>...</td>
      <td>572.0</td>
      <td>581.0</td>
      <td>435.0</td>
      <td>341.0</td>
      <td>252.0</td>
      <td>182.0</td>
      <td>249.0</td>
      <td>274.0</td>
      <td>328.0</td>
      <td>261.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 125 columns</p>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;1969_rank&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">615</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[2999]</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx_20</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">idx_80</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_rank&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">idx_20_i</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">==</span><span class="n">ridx_20</span><span class="p">]</span>
    <span class="n">idx_20</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">idx_20_i</span><span class="p">)</span>
    <span class="n">idx_80_i</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">==</span><span class="n">ridx_80</span><span class="p">]</span>
    <span class="n">idx_80</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">idx_80_i</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">idx_20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>49</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>49</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx_20</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_80</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2999, 853)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">8999</span><span class="p">,</span> <span class="mi">2561</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2a160b8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_169_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">idx_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idx_80</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2a6e5f8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_170_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span><span class="n">Polygon</span>
<span class="n">geom</span><span class="o">=</span><span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mf">117.454361</span><span class="p">,</span><span class="mf">117.459880</span><span class="p">],[</span><span class="mf">38.8459879</span><span class="p">,</span><span class="mf">38.846255</span><span class="p">])]</span>
<span class="n">ldf</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geom</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;init&#39;</span><span class="p">:</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">})</span>
<span class="n">ldf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">l</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">ldf</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0                NaN
1       9.956789e+06
2                NaN
3                NaN
4                NaN
            ...     
3072             NaN
3073             NaN
3074             NaN
3075             NaN
3076             NaN
Length: 3077, dtype: float64
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ldf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">({</span><span class="s1">&#39;init&#39;</span><span class="p">:</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ldf</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">idx_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idx_80</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c29de470&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_173_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ldf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3310</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ldf</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">idx_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idx_80</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c29ea860&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_175_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small</span> <span class="o">=</span> <span class="n">ldf</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">idx_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idx_80</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1969</th>
      <th>1970</th>
      <th>1971</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>...</th>
      <th>2008_rank</th>
      <th>2009_rank</th>
      <th>2010_rank</th>
      <th>2011_rank</th>
      <th>2012_rank</th>
      <th>2013_rank</th>
      <th>2014_rank</th>
      <th>2015_rank</th>
      <th>2016_rank</th>
      <th>2017_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2067</th>
      <td>2524</td>
      <td>2822</td>
      <td>2889</td>
      <td>3272</td>
      <td>4291</td>
      <td>4187</td>
      <td>4692</td>
      <td>4866</td>
      <td>4838</td>
      <td>5573</td>
      <td>...</td>
      <td>443.0</td>
      <td>368.0</td>
      <td>413.0</td>
      <td>565.0</td>
      <td>677.0</td>
      <td>793.0</td>
      <td>911.0</td>
      <td>671.0</td>
      <td>336.0</td>
      <td>615.0</td>
    </tr>
    <tr>
      <th>802</th>
      <td>3857</td>
      <td>4191</td>
      <td>4002</td>
      <td>4543</td>
      <td>5992</td>
      <td>6032</td>
      <td>6548</td>
      <td>6748</td>
      <td>7088</td>
      <td>8623</td>
      <td>...</td>
      <td>2648.0</td>
      <td>2470.0</td>
      <td>2523.0</td>
      <td>2691.0</td>
      <td>2725.0</td>
      <td>2641.0</td>
      <td>2607.0</td>
      <td>2543.0</td>
      <td>2387.0</td>
      <td>2461.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 125 columns</p>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">small</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>850261.9196986001</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2067    POINT (1951075.651540128 -92377.34360965305)
802      POINT (2180153.890714678 794694.7258680048)
dtype: object</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx_20</span><span class="p">,</span> <span class="n">idx_80</span><span class="p">)</span>
<span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
    <span class="n">o</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="c1">#print(o,d, idx)</span>
    <span class="n">pair</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distances</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[5.793494382777284,
 14.11115326544592,
 23.2298009066525,
 40.11641752788748,
 20.914297628557865,
 15.407105868272607,
 15.062971646920277,
 5.211649001807871,
 6.775426703442077,
 20.44265510167664,
 26.634752051829775,
 12.073695525805052,
 19.652499316239574,
 30.230796317568768,
 8.64932110490182,
 17.265616788606682,
 19.71670513883587,
 5.524698660218939,
 11.600260332271942,
 5.087227637574814,
 9.801452050512967,
 21.28086269714102,
 6.908859229154765,
 2.6155873939000664,
 5.117607798677233,
 13.553946040774992,
 18.33894677181762,
 13.402089350099104,
 6.850039879449605,
 37.52152272031369,
 6.2350626620115,
 9.94556852242646,
 6.351398267403174,
 7.822608143168172,
 20.866735819375897,
 28.401936409641596,
 11.916935086505633,
 16.70377904984774,
 20.862802519703873,
 7.243244383111751,
 5.112943017199099,
 11.10901592550902,
 19.917613899026676,
 13.590977880673961,
 27.178095806423322,
 4.763282149202798,
 5.289851836809796,
 10.360359657532838,
 8.234454089168326]</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx_20</span><span class="p">,</span> <span class="n">idx_80</span><span class="p">)</span>

<span class="nb">len</span><span class="p">(</span><span class="n">distances</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">idxs</span><span class="p">))</span>
<span class="n">gini_df</span><span class="p">[</span><span class="s1">&#39;s_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gini_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;s_dist&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2a4b2e8&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_183_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">idx_20</span><span class="p">,</span> <span class="n">idx_80</span><span class="p">)))</span>
<span class="n">idxs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[2999,  853],
       [ 305, 1810],
       [1661,  264],
       [ 352, 2770],
       [ 333, 2330],
       [2886, 1313],
       [ 465, 1666],
       [1500,  684],
       [2241,  667],
       [2688, 2200],
       [ 320, 1587],
       [2980, 1456],
       [ 462, 3041],
       [2999, 2213],
       [ 436,  555],
       [1168, 1302],
       [1574, 1637],
       [2127,  810],
       [ 453,    6],
       [1975,  434],
       [  47,  924],
       [1343, 2890],
       [ 174, 2621],
       [ 633, 2359],
       [2059, 2650],
       [ 130,  882],
       [1343, 1878],
       [1004, 1345],
       [  97,  591],
       [ 486, 2763],
       [ 965, 1233],
       [1624,  822],
       [ 206,  495],
       [1448,   48],
       [1231, 3021],
       [2644, 2779],
       [ 888, 2856],
       [2979,  755],
       [2355, 1960],
       [1655,  803],
       [1229,   37],
       [1410, 1653],
       [ 179, 1770],
       [ 140, 2807],
       [ 247,  948],
       [1056, 1490],
       [1034,   33],
       [2085, 1348],
       [2067,  802]])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2a36160&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_185_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc8c2a4b710&gt;</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_186_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_187_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_188_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rank-paths">Rank paths<a class="anchor-link" href="#Rank-paths"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">LineString</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls20</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
<span class="n">ls80</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
<span class="n">ls20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
<span class="n">ls80</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="c1">#gdf.plot(ax=ax,edgecolor=&#39;gray&#39;, alpha=0.2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rank Paths (80pct Blue, 20pct Red)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_192_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax_array</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">year</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_array</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">axes</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_row</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">43</span><span class="p">:</span>
            <span class="n">ls20</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="n">year</span><span class="p">:</span><span class="n">year</span><span class="o">+</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">ls20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
            <span class="n">ls80</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="n">year</span><span class="p">:</span><span class="n">year</span><span class="o">+</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">ls80</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
    
        <span class="n">year</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1">#         axes.plot(you_data_goes_here,&#39;r-&#39;)</span>
        <span class="c1">#axes.set_aspect(&#39;equal&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_193_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax_array</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">year</span><span class="o">=</span><span class="mi">2</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_array</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">axes</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax_row</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="p">:</span>
            <span class="n">ls20</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">year</span><span class="p">]))</span>
            <span class="n">ls20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
            <span class="n">ls80</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">year</span><span class="p">]))</span>
            <span class="n">ls80</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
    
        <span class="n">year</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1">#         axes.plot(you_data_goes_here,&#39;r-&#39;)</span>
        <span class="c1">#axes.set_aspect(&#39;equal&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_194_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">48</span><span class="p">):</span>
    <span class="c1">#print(0,i)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
    <span class="n">ls20</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ls20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
    <span class="n">ls80</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">LineString</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],:]</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ls80</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20p&#39;</span><span class="p">)</span>
    
    <span class="c1">#ls80.plot(ax=ax, color=&#39;b&#39;)</span>
    <span class="c1">#gdf.plot(ax=ax,edgecolor=&#39;gray&#39;, alpha=0.2)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Percentile Paths 1969-</span><span class="si">{}</span><span class="s1"> (80p Blue, 20p Red)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1969</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:3: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  This is separate from the ipykernel package so we can avoid doing imports until
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_1.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_2.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_3.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_4.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_5.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_6.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_7.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_8.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_9.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_10.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_11.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_12.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_13.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_14.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_15.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_16.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_17.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_18.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_19.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_20.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_21.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_22.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_23.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_24.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_25.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_26.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_27.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_28.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_29.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_30.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_31.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_32.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_33.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_34.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_35.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_36.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_37.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_38.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_39.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_40.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_41.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_42.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_43.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_44.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_45.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/notebooks/09_spatial_inequality_195_46.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
<!-- #endregion --></p>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/book/intro_part_iii.html">
      〈 <span class="u-margin-right-tiny"></span> Part III - Advanced Topics
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/book/notebooks/10_clustering_and_regionalization.html">
      Clustering & Regionalization <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer"><a href="https://geographicdata.science/">Geographic Data Science with PySAL and the PyData Stack</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
